import{L as l,Zb as d,l as n,n as c,q as s,w as p,y as o}from"./chunk-QCVMPDFW.js";var u=class a{pb;COLLECTION="inspections";constructor(){this.pb=new d("https://db.buckapi.site:8095")}createInspection(e){return n(this.pb.collection(this.COLLECTION).create(e)).pipe(s(t=>t),o(this.handleError))}getAllInspections(e=1,t=50,r="-created",b){return n(this.pb.collection(this.COLLECTION).getList(e,t,{sort:r,filter:b,$autoCancel:!1})).pipe(s(i=>({items:i.items,totalItems:i.totalItems,totalPages:i.totalPages,page:i.page})),o(this.handleError))}getInspectionById(e){return n(this.pb.collection(this.COLLECTION).getOne(e)).pipe(s(t=>t),o(this.handleError))}searchByPlaca(e){return this.getAllInspections(1,50,"-created",`placa~"${e}"`).pipe(s(t=>t.items))}getInspectionsByEstado(e){return this.getAllInspections(1,100,"-created",`estado="${e}"`).pipe(s(t=>t.items))}updateInspection(e,t){return n(this.pb.collection(this.COLLECTION).update(e,t)).pipe(s(r=>r),o(this.handleError))}updateEstado(e,t){return this.updateInspection(e,{estado:t})}deleteInspection(e){return n(this.pb.collection(this.COLLECTION).delete(e)).pipe(o(this.handleError))}deleteMultipleInspections(e){let t=e.map(r=>this.deleteInspection(r));return p(t)}handleError(e){let t="Error desconocido";if(e instanceof Error)t=e.message;else if(e?.response){let r=e.status||e.response?.code||500;switch(r){case 400:t="Datos inv\xE1lidos o incompletos";break;case 401:t="No autorizado. Por favor inicie sesi\xF3n";break;case 403:t="Acceso denegado";break;case 404:t="Recurso no encontrado";break;case 409:t="Conflicto: El registro ya existe";break;case 500:t="Error interno del servidor";break;default:t=`Error ${r}: ${e.message||"Error desconocido"}`}}return console.error("Error en InspectionService:",t,e),c(()=>new Error(t))}validateInspectionData(e){let t=[];return e.nombre_transportadora||t.push("Nombre de transportadora es requerido"),e.nombres_conductor||t.push("Nombre del conductor es requerido"),e.identificacion||t.push("Identificaci\xF3n es requerida"),e.telefono||t.push("Tel\xE9fono es requerido"),e.placa||t.push("Placa es requerida"),e.marca||t.push("Marca es requerida"),e.modelo||t.push("Modelo es requerido"),(e.kilometraje===void 0||e.kilometraje===null)&&t.push("Kilometraje es requerido"),{valid:t.length===0,errors:t}}getStats(){return this.getAllInspections(1,1).pipe(s(e=>({total:e.totalItems,page:e.page,totalPages:e.totalPages})))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{u as a};

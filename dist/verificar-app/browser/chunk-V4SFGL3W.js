import{a as j}from"./chunk-VWUSJTPT.js";import{f as B,g as z,i as A}from"./chunk-SL65TR4P.js";import{a as R,c as Y,f as W,p as $}from"./chunk-LRBWCEYN.js";import{$a as p,Ea as x,Ja as v,Mb as N,Na as I,Nb as D,Ob as F,Rb as L,Tb as V,Ua as b,V as d,Va as e,W as f,Wa as n,Xa as l,Yb as H,_a as C,ab as _,e as G,hb as o,ib as u,jb as k,kb as w,lb as S,mb as M,nb as y,pb as E,rb as P,tb as O,vb as T,wa as s}from"./chunk-QCVMPDFW.js";var g=G(H());var J=()=>["approved","rejected"],K=(m,i,t)=>({"bg-success":m,"bg-warning":i,"bg-soft-primary":t});function Q(m,i){if(m&1){let t=C();e(0,"tr",42),p("click",function(){let r=d(t).$implicit,c=_();return f(c.viewInspection(r.id))}),e(1,"td",34)(2,"div",43)(3,"input",44),p("click",function(r){return d(t),f(r.stopPropagation())}),n()()(),e(4,"td")(5,"div",45)(6,"div",46),l(7,"i",47),n(),e(8,"span",48),o(9),n()()(),e(10,"td")(11,"span",49),o(12),n()(),e(13,"td")(14,"span",29),o(15),n()(),e(16,"td")(17,"span",29),o(18),O(19,"date"),n()(),e(20,"td")(21,"span",50),o(22),n()(),e(23,"td",51)(24,"div",52)(25,"button",53),p("click",function(r){let c=d(t).$implicit,h=_();return r.stopPropagation(),f(h.viewInspection(c.id))}),l(26,"i",54),n(),e(27,"button",55),p("click",function(r){return d(t),f(r.stopPropagation())}),l(28,"i",56),n(),e(29,"button",57),p("click",function(r){let c=d(t).$implicit,h=_();return f(h.deleteInspection(r,c.id))}),l(30,"i",58),n()()()()}if(m&2){let t=i.$implicit;s(9),u(t.nombres_conductor||"N/A"),s(3),u(t.placa||"N/A"),s(3),u(t.telefono||"N/A"),s(3),u(t.fecha_inspeccion?T(19,6,t.fecha_inspeccion,"dd/MM/yyyy"):"N/A"),s(3),b("ngClass",P(10,K,t.status==="approved",t.status==="rejected",!E(9,J).includes(t.status||""))),s(),k(" ",t.status||"N/A"," ")}}function U(m,i){m&1&&(e(0,"tr")(1,"td",59)(2,"div",60),l(3,"i",61),e(4,"p",28),o(5,"No se encontraron inspecciones"),n(),e(6,"small",29),o(7,"Intenta con otros t\xE9rminos de b\xFAsqueda"),n()()()())}var q=class m{constructor(i,t){this.realtimeInspectionsService=i;this.router=t}inspections=[];totalInspections=0;currentMonthInspections=0;filteredInspections=[];searchTerm="";ngOnInit(){this.initializeData()}pending(){g.default.fire({title:"Opcion por implementar",text:"Se implementara en el despliegue final",icon:"warning"})}initializeData(){this.realtimeInspectionsService.inspections$.subscribe({next:i=>{this.inspections=i,this.filteredInspections=[...i],this.totalInspections=i.length,this.currentMonthInspections=i.filter(t=>{if(!t.fecha_inspeccion)return!1;let a=new Date(t.fecha_inspeccion),r=new Date;return a.getMonth()===r.getMonth()&&a.getFullYear()===r.getFullYear()}).length},error:i=>{console.error("Error al cargar inspecciones:",i)}})}onSearch(){if(!this.searchTerm.trim()){this.filteredInspections=[...this.inspections];return}let i=this.searchTerm.toLowerCase().trim();this.filteredInspections=this.inspections.filter(t=>t.id_inspeccion?.toLowerCase().includes(i)||t.estado?.toLowerCase().includes(i)||t.vehiculo?.placa?.toLowerCase().includes(i)||t.vehiculo?.marca?.toLowerCase().includes(i)||t.vehiculo?.modelo?.toLowerCase().includes(i))}viewInspection(i){if(!i){console.error("No se pudo obtener el ID de la inspecci\xF3n");return}this.router.navigate(["/detail",i])}async deleteInspection(i,t){if(i.stopPropagation(),!t){console.error("No se pudo obtener el ID de la inspecci\xF3n");return}if((await g.default.fire({title:"\xBFEst\xE1s seguro?",text:"Esta acci\xF3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await this.realtimeInspectionsService.deleteInspection(t),g.default.fire({title:"Eliminada",text:"La inspecci\xF3n ha sido eliminada",icon:"success",confirmButtonText:"Aceptar"})}catch(r){console.error("Error al eliminar la inspecci\xF3n:",r),g.default.fire({title:"Error",text:"No se pudo eliminar la inspecci\xF3n",icon:"error",confirmButtonText:"Aceptar"})}}static \u0275fac=function(t){return new(t||m)(x(j),x(B))};static \u0275cmp=v({type:m,selectors:[["app-inspections"]],decls:67,vars:5,consts:[[1,"app-wrapper"],[1,"container-fluid"],[1,"app-page-head","d-flex","align-items-center","justify-content-between"],["aria-label","breadcrumb"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],["routerLink","/"],[1,"fi","fi-rr-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","gap-2"],[1,"search-box"],["type","text","placeholder","Buscar inspecciones...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"fi","fi-rr-search"],[1,"d-flex","align-items-center","gap-2","position-relative"],["type","checkbox","id","inspections-fab-check",1,"fab-check"],["for","inspections-fab-check",1,"btn","btn-primary","waves-effect","waves-light"],[1,"fi","fi-rr-plus","me-1"],[1,"fab-options","d-flex","flex-column",2,"bottom","auto","top","100%","right","0","left","auto","transform-origin","top right","z-index","1050"],["routerLink","/busetas",1,"fab-option",3,"click"],[1,"fab-label"],[1,"fab-option-icon"],["routerLink","/nueva",1,"fab-option",3,"click"],[1,"fab-option",3,"click"],[1,"fab-label","text-warning"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","align-items-center","justify-content-between"],[1,"mb-0"],[1,"text-muted"],[1,"card-body","px-1","pt-2","pb-2"],[1,"table-responsive"],["id","dt_Inspections",1,"table","table-sm","display","table-row-rounded","data-row-checkbox"],[1,"table-light"],[1,"pe-0"],[1,"form-check"],["data-row-checkbox","","type","checkbox",1,"form-check-input"],[1,"minw-200px"],[1,"minw-150px"],[1,"minw-125px"],["style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[2,"cursor","pointer",3,"click"],[1,"form-check","p-0","w-auto","d-inline-block","mb-0","mb-n1"],["data-checkbox","","type","checkbox",1,"form-check-input","m-0",3,"click"],[1,"d-flex","align-items-center"],[1,"avatar","avatar-circle","avatar-xs","me-2"],[1,"fi","fi-rr-user"],[1,"fw-semibold"],[1,""],[1,"badge",3,"ngClass"],[1,"text-center"],[1,"d-flex","gap-2","justify-content-center"],["title","Ver",1,"btn","btn-sm","btn-icon","btn-soft-primary",3,"click"],[1,"fi","fi-rr-eye"],["title","Editar",1,"btn","btn-sm","btn-icon","btn-soft-info",3,"click"],[1,"fi","fi-rr-edit"],["title","Eliminar",1,"btn","btn-sm","btn-icon","btn-soft-danger",3,"click"],[1,"fi","fi-rr-trash"],["colspan","9",1,"text-center","py-4"],[1,"d-flex","flex-column","align-items-center"],[1,"fi","fi-rr-search-alt","text-muted","mb-2",2,"font-size","2rem"]],template:function(t,a){t&1&&(e(0,"main",0)(1,"div",1)(2,"div",2)(3,"nav",3)(4,"ol",4)(5,"li",5)(6,"a",6),l(7,"i",7),o(8," Inicio "),n()(),e(9,"li",8),o(10,"Listado de Inspecciones"),n()()(),e(11,"div",9)(12,"div",10)(13,"input",11),y("ngModelChange",function(c){return M(a.searchTerm,c)||(a.searchTerm=c),c}),p("input",function(){return a.onSearch()}),n(),l(14,"i",12),n(),e(15,"div",13),l(16,"input",14),e(17,"label",15),l(18,"i",16),o(19," Nueva Inspecci\xF3n "),n(),e(20,"div",17)(21,"a",18),p("click",function(c){return c.stopPropagation()}),e(22,"span",19),o(23,"Busetas"),n(),e(24,"span",20),o(25,"1"),n()(),e(26,"a",21),p("click",function(c){return c.stopPropagation()}),e(27,"span",19),o(28,"Camioneta"),n(),e(29,"span",20),o(30,"2"),n()(),e(31,"a",22),p("click",function(){return a.pending()})("click",function(c){return c.stopPropagation()}),e(32,"span",23),o(33,"Pesados"),n(),e(34,"span",20),o(35,"3"),n()()()()()(),e(36,"div",24)(37,"div",25)(38,"div",26)(39,"div",27)(40,"h5",28),o(41,"Inspecciones"),n(),e(42,"div",29),o(43),n()(),e(44,"div",30)(45,"div",31)(46,"table",32)(47,"thead",33)(48,"tr")(49,"th",34)(50,"div",35),l(51,"input",36),n()(),e(52,"th",37),o(53,"Conductor"),n(),e(54,"th",38),o(55,"Placa del veh\xEDculo"),n(),e(56,"th",38),o(57,"Tel\xE9fono"),n(),e(58,"th",39),o(59,"Fecha"),n(),e(60,"th"),o(61,"Status"),n(),e(62,"th"),o(63,"Acci\xF3n"),n()()(),e(64,"tbody"),I(65,Q,31,14,"tr",40)(66,U,8,0,"tr",41),n()()()()()()()()()),t&2&&(s(13),S("ngModel",a.searchTerm),s(30),w(" Total: ",a.totalInspections," | Este mes: ",a.currentMonthInspections," "),s(22),b("ngForOf",a.filteredInspections),s(),b("ngIf",a.filteredInspections.length===0))},dependencies:[V,N,D,F,A,z,$,R,Y,W,L],styles:['.fab-check[_ngcontent-%COMP%]{display:none}.fab-check[_ngcontent-%COMP%]:checked ~ .fab-options[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:scale(1) translateY(0)}.fab-options[_ngcontent-%COMP%]{position:absolute;min-width:200px;background:#fff;border-radius:8px;box-shadow:0 5px 15px #0000001a;opacity:0;visibility:hidden;transform:scale(.95) translateY(-10px);transform-origin:top right;transition:all .2s ease-in-out;z-index:1000;padding:.5rem 0;margin-top:.5rem;right:0}.fab-options[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-8px;right:16px;width:16px;height:16px;background:#fff;transform:rotate(45deg);box-shadow:-2px -2px 5px #0000000d}.fab-option[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.6rem 1.25rem;color:#495057;text-decoration:none;transition:all .2s;position:relative;z-index:1}.fab-option[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;color:green;transform:translate(3px)}.fab-option[_ngcontent-%COMP%]:hover   .fab-label[_ngcontent-%COMP%]{color:green}.fab-option[_ngcontent-%COMP%]:hover   .fab-option-icon[_ngcontent-%COMP%]{background-color:green;color:#fff}.fab-option[_ngcontent-%COMP%]   .fab-label[_ngcontent-%COMP%]{flex:1;font-size:.875rem;transition:color .2s}.fab-option[_ngcontent-%COMP%]   .fab-option-icon[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:4px;background-color:#f8f9fa;color:#6c757d;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:600;transition:all .2s}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .3s ease;cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a;z-index:1;position:relative}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff;transition:background-color .3s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f8f9fa}.btn[_ngcontent-%COMP%]{cursor:pointer}.badge[_ngcontent-%COMP%]{padding:.5em .8em;font-size:.85em;font-weight:500;border-radius:.25rem}.badge.bg-soft-primary[_ngcontent-%COMP%]{background-color:#0d6efd1a;color:green}']})};export{q as Inspections};
